generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgres://gzibkeghhcxlfq:81c60eaff2267799b3a0e3a6e9cc829ec97bd97dbdf6c61b7827287d29d4f9df@ec2-34-194-100-156.compute-1.amazonaws.com:5432/ddo6pnpikd2ji3"
}

model guild {
  id         Int      @id() @default(autoincrement())
  guildId    String   @unique() 
  joinedTime DateTime @db.Timestamp(6)
  prefix     String   @default("g")
  disabled   String[]
  member     member[]
}

model member {
  id           Int           @id() @default(autoincrement())
  guildid      String
  userid       String
  guild        guild         @relation(fields: [guildid], references: [guildId], onDelete: Cascade, onUpdate: Cascade)
  deleted_msg  deleted_msg[]
  member_level member_level?

  @@unique([guildid, userid])
}

model member_level {
  memberID    String
  guildID     String
  level       Int    @default(1)
  nextLevelXp Int @default(100)
  xp          Int @default(0)
  member      member @relation(fields: [memberID, guildID], references: [userid, guildid], onDelete: Cascade)
  @@id([memberID, guildID])
  @@unique([memberID, guildID])
}

model deleted_msg {
  id          Int      @id() @default(autoincrement())
  author      String
  content     String
  guildId     String
  msgTime     DateTime @db.Timestamp(6)
  channel     String
  deletedTime DateTime @db.Timestamp(6)
  deletedBy   String   @db.VarChar(200)
  msgId       String   @unique()
  attachments Json?
  member      member   @relation(fields: [author, guildId], references: [userid, guildid], onDelete: Cascade, onUpdate: Cascade)
}

model scheduled_task {
  id      Int      @id() @default(autoincrement())
  task    String   @db.VarChar(255)
  context Json?    @db.Json
  time    DateTime @db.Timestamp(6)
  done    Boolean  @default(false)
}
